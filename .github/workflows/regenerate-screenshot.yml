name: Regenerate TUI Screenshot

on:
  workflow_dispatch:  # Manual trigger only

permissions:
  contents: write
  pull-requests: write

jobs:
  regenerate:
    name: Regenerate Screenshot
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v6
      with:
        fetch-depth: 0  # For hatch-vcs
    
    - name: Set up Python 3.12
      uses: actions/setup-python@v6
      with:
        python-version: "3.12"
    
    - name: Install uv
      uses: astral-sh/setup-uv@v5
      with:
        version: "latest"
    
    - name: Install dependencies
      run: |
        uv sync
    
    - name: Regenerate TUI screenshot
      run: |
        uv run python scripts/capture_tui_screenshot.py
    
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v7
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: "chore: regenerate TUI screenshot"
        branch: regenerate-screenshot
        title: "chore: Regenerate TUI Screenshot"
        body: |
          ## Screenshot Regeneration
          
          This PR updates the TUI screenshot in `docs/tui-screenshot.svg`.
          
          **Generated by:** @${{ github.actor }}
          **Workflow:** Regenerate TUI Screenshot (manual trigger)
          
          Please review the updated screenshot and merge if it looks correct.
        labels: documentation, automated
